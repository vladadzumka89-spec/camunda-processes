<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions
  xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL"
  xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
  xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
  xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
  xmlns:zeebe="http://camunda.org/schema/zeebe/1.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:modeler="http://camunda.org/schema/modeler/1.0"
  id="Definitions_DO3_Test"
  targetNamespace="http://bpmn.io/schema/bpmn"
  exporter="Camunda Modeler"
  exporterVersion="5.16.0"
  modeler:executionPlatform="Camunda Cloud"
  modeler:executionPlatformVersion="8.8.0">

  <!-- ============================================================ -->
  <!-- PROCESS                                                       -->
  <!-- ============================================================ -->
  <bpmn:process id="Process_DO3_Integration" name="Інтеграція ДО3 (тест)" isExecutable="true">

    <!-- ========================================================== -->
    <!-- СТАРТ                                                       -->
    <!-- ========================================================== -->
    <bpmn:startEvent id="StartEvent_1" name="Старт">
      <bpmn:outgoing>Flow_To_Form</bpmn:outgoing>
    </bpmn:startEvent>

    <bpmn:sequenceFlow id="Flow_To_Form" sourceRef="StartEvent_1" targetRef="Activity_RegistrationForm" />

    <!-- ========================================================== -->
    <!-- КРОК 0: Форма вводу даних                                   -->
    <!-- ========================================================== -->
    <bpmn:userTask id="Activity_RegistrationForm" name="Ввод даних персони">
      <bpmn:extensionElements>
        <zeebe:formDefinition formId="person-data-form" />
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_To_Form</bpmn:incoming>
      <bpmn:outgoing>Flow_To_ST1</bpmn:outgoing>
    </bpmn:userTask>

    <bpmn:sequenceFlow id="Flow_To_ST1" sourceRef="Activity_RegistrationForm" targetRef="ST1_CreateDoc" />

    <!-- ========================================================== -->
    <!-- КРОК 1: Створити документ (REST)                            -->
    <!--   Відправляємо первинні параметри (ім'я, прізвище…)         -->
    <!--   Отримуємо: {status:"OK", documentID:"123…"}               -->
    <!-- ========================================================== -->
    <bpmn:serviceTask id="ST1_CreateDoc" name="(1) Створити документ">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="io.camunda:http-json:1" />
        <zeebe:taskHeaders>
          <zeebe:header key="url" value="{{secrets.DO3_Link}}" />
          <zeebe:header key="method" value="POST" />
          <zeebe:header key="authentication.type" value="basic" />
          <zeebe:header key="authentication.username" value="{{secrets.DO3_Login}}" />
          <zeebe:header key="authentication.password" value="{{secrets.DO3_Pass}}" />
        </zeebe:taskHeaders>
        <zeebe:ioMapping>
          <zeebe:input source="={Name: Name, Surname: Surname, Patronicname: Patronicname, BDay: BDay, Sex: Sex}" target="body" />
          <zeebe:output source="=if response.statusCode = 200 or response.statusCode = 201 then if response.body.status = &quot;OK&quot; then {documentID: response.body.documentID, isAbort: false} else {Step: 0, ErrorMessage: response.body.message, isAbort: true} else {Step: 0, ErrorMessage: &quot;REST Error: &quot; + string(response.statusCode), isAbort: true}" target="op1" />
          <zeebe:output source="=op1.documentID" target="documentID" />
          <zeebe:output source="=op1.ErrorMessage" target="ErrorMessage" />
        </zeebe:ioMapping>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_To_ST1</bpmn:incoming>
      <bpmn:outgoing>Flow_ST1_to_GW1</bpmn:outgoing>
    </bpmn:serviceTask>

    <bpmn:sequenceFlow id="Flow_ST1_to_GW1" sourceRef="ST1_CreateDoc" targetRef="GW1" />

    <!-- Gateway 1 -->
    <bpmn:exclusiveGateway id="GW1" name="Документ створено?">
      <bpmn:incoming>Flow_ST1_to_GW1</bpmn:incoming>
      <bpmn:outgoing>Flow_GW1_ok</bpmn:outgoing>
      <bpmn:outgoing>Flow_GW1_err</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <bpmn:sequenceFlow id="Flow_GW1_ok" name="OK" sourceRef="GW1" targetRef="ST2_TriggerFO">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=op1.isAbort = false</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_GW1_err" name="Помилка" sourceRef="GW1" targetRef="EndEvent_Abort">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=op1.isAbort = true</bpmn:conditionExpression>
    </bpmn:sequenceFlow>

    <!-- ========================================================== -->
    <!-- КРОК 2: Запустити скрипт "Створити ФО" (REST)               -->
    <!--   Відправляємо: {documentID, СтворитиФізособу: true}        -->
    <!--   Отримуємо: {status:"OK"}                                  -->
    <!-- ========================================================== -->
    <bpmn:serviceTask id="ST2_TriggerFO" name="(2) Запустити скрипт ФО">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="io.camunda:http-json:1" />
        <zeebe:taskHeaders>
          <zeebe:header key="url" value="{{secrets.DO3_Link}}" />
          <zeebe:header key="method" value="POST" />
          <zeebe:header key="authentication.type" value="basic" />
          <zeebe:header key="authentication.username" value="{{secrets.DO3_Login}}" />
          <zeebe:header key="authentication.password" value="{{secrets.DO3_Pass}}" />
        </zeebe:taskHeaders>
        <zeebe:ioMapping>
          <zeebe:input source="={documentID: documentID, createDocument: true, properties: {&quot;Наименование&quot;: &quot;Петренко Петро Петрович&quot;, &quot;ДатаРождения&quot;: &quot;1999-03-01&quot;, &quot;Пол&quot;: &quot;Мужской&quot;}, contact_information: {phone: &quot;+380665554433&quot;, email: &quot;1@1.com&quot;}}" target="body" />
          <zeebe:output source="=if response.statusCode = 200 or response.statusCode = 201 then if response.body.status = &quot;OK&quot; then {isAbort: false} else {Step: 2, ErrorMessage: response.body.message, isAbort: true} else {Step: 2, ErrorMessage: &quot;REST Error Step 2&quot;, isAbort: true}" target="op2" />
          <zeebe:output source="=op2.ErrorMessage" target="ErrorMessage" />
        </zeebe:ioMapping>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_GW1_ok</bpmn:incoming>
      <bpmn:outgoing>Flow_ST2_to_GW2</bpmn:outgoing>
    </bpmn:serviceTask>

    <bpmn:sequenceFlow id="Flow_ST2_to_GW2" sourceRef="ST2_TriggerFO" targetRef="GW2" />

    <!-- Gateway 2 -->
    <bpmn:exclusiveGateway id="GW2" name="Скрипт ФО запущено?">
      <bpmn:incoming>Flow_ST2_to_GW2</bpmn:incoming>
      <bpmn:outgoing>Flow_GW2_ok</bpmn:outgoing>
      <bpmn:outgoing>Flow_GW2_err</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <bpmn:sequenceFlow id="Flow_GW2_ok" name="OK" sourceRef="GW2" targetRef="Msg1_PersonCreated">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=op2.isAbort = false</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_GW2_err" name="Помилка" sourceRef="GW2" targetRef="EndEvent_Abort">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=op2.isAbort = true</bpmn:conditionExpression>
    </bpmn:sequenceFlow>

    <!-- ========================================================== -->
    <!-- КРОК 3: Очікування сигналу "ФО створено"                    -->
    <!--   Отримуємо: {status:"OK", personID:"54545…"}               -->
    <!-- ========================================================== -->
    <bpmn:intermediateCatchEvent id="Msg1_PersonCreated" name="Очікування:&#10;ФО створено">
      <bpmn:extensionElements>
        <zeebe:ioMapping>
          <zeebe:output source="=if status = &quot;OK&quot; then {personID: personID, isAbort: false} else {Step: 3, ErrorMessage: message, isAbort: true}" target="op3" />
          <zeebe:output source="=op3.personID" target="personID" />
          <zeebe:output source="=op3.ErrorMessage" target="ErrorMessage" />
        </zeebe:ioMapping>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_GW2_ok</bpmn:incoming>
      <bpmn:outgoing>Flow_Msg1_to_GW3</bpmn:outgoing>
      <bpmn:messageEventDefinition id="MsgDef_PersonCreated" messageRef="Msg_PersonCreated" />
    </bpmn:intermediateCatchEvent>

    <bpmn:sequenceFlow id="Flow_Msg1_to_GW3" sourceRef="Msg1_PersonCreated" targetRef="GW3" />

    <!-- Gateway 3 -->
    <bpmn:exclusiveGateway id="GW3" name="ФО створено?">
      <bpmn:incoming>Flow_Msg1_to_GW3</bpmn:incoming>
      <bpmn:outgoing>Flow_GW3_ok</bpmn:outgoing>
      <bpmn:outgoing>Flow_GW3_err</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <bpmn:sequenceFlow id="Flow_GW3_ok" name="OK" sourceRef="GW3" targetRef="ST3_TriggerEmployee">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=op3.isAbort = false</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_GW3_err" name="Помилка" sourceRef="GW3" targetRef="EndEvent_Abort">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=op3.isAbort = true</bpmn:conditionExpression>
    </bpmn:sequenceFlow>

    <!-- ========================================================== -->
    <!-- КРОК 4: Запустити скрипт "Створити співробітника" (REST)     -->
    <!--   Відправляємо: {documentID, СтворитиСпівробітника: true}   -->
    <!--   Отримуємо: {status:"OK"}                                  -->
    <!-- ========================================================== -->
    <bpmn:serviceTask id="ST3_TriggerEmployee" name="(4) Запустити скрипт Співробітника">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="io.camunda:http-json:1" />
        <zeebe:taskHeaders>
          <zeebe:header key="url" value="{{secrets.DO3_Link}}" />
          <zeebe:header key="method" value="POST" />
          <zeebe:header key="authentication.type" value="basic" />
          <zeebe:header key="authentication.username" value="{{secrets.DO3_Login}}" />
          <zeebe:header key="authentication.password" value="{{secrets.DO3_Pass}}" />
        </zeebe:taskHeaders>
        <zeebe:ioMapping>
          <zeebe:input source="={documentID: documentID, &quot;СтворитиСпівробітника&quot;: true}" target="body" />
          <zeebe:output source="=if response.statusCode = 200 or response.statusCode = 201 then if response.body.status = &quot;OK&quot; then {isAbort: false} else {Step: 4, ErrorMessage: response.body.message, isAbort: true} else {Step: 4, ErrorMessage: &quot;REST Error Step 4&quot;, isAbort: true}" target="op4" />
          <zeebe:output source="=op4.ErrorMessage" target="ErrorMessage" />
        </zeebe:ioMapping>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_GW3_ok</bpmn:incoming>
      <bpmn:outgoing>Flow_ST3_to_GW4</bpmn:outgoing>
    </bpmn:serviceTask>

    <bpmn:sequenceFlow id="Flow_ST3_to_GW4" sourceRef="ST3_TriggerEmployee" targetRef="GW4" />

    <!-- Gateway 4 -->
    <bpmn:exclusiveGateway id="GW4" name="Скрипт запущено?">
      <bpmn:incoming>Flow_ST3_to_GW4</bpmn:incoming>
      <bpmn:outgoing>Flow_GW4_ok</bpmn:outgoing>
      <bpmn:outgoing>Flow_GW4_err</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <bpmn:sequenceFlow id="Flow_GW4_ok" name="OK" sourceRef="GW4" targetRef="Msg2_EmployeeCreated">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=op4.isAbort = false</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_GW4_err" name="Помилка" sourceRef="GW4" targetRef="EndEvent_Abort">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=op4.isAbort = true</bpmn:conditionExpression>
    </bpmn:sequenceFlow>

    <!-- ========================================================== -->
    <!-- КРОК 5: Очікування сигналу "Співробітника створено"         -->
    <!--   Отримуємо: {status:"OK", employeeID:"…"}                  -->
    <!-- ========================================================== -->
    <bpmn:intermediateCatchEvent id="Msg2_EmployeeCreated" name="Очікування:&#10;Співробітника створено">
      <bpmn:extensionElements>
        <zeebe:ioMapping>
          <zeebe:output source="=if status = &quot;OK&quot; then {employeeID: employeeID, isAbort: false} else {Step: 5, ErrorMessage: message, isAbort: true}" target="op5" />
          <zeebe:output source="=op5.employeeID" target="employeeID" />
          <zeebe:output source="=op5.ErrorMessage" target="ErrorMessage" />
        </zeebe:ioMapping>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_GW4_ok</bpmn:incoming>
      <bpmn:outgoing>Flow_Msg2_to_GW5</bpmn:outgoing>
      <bpmn:messageEventDefinition id="MsgDef_EmployeeCreated" messageRef="Msg_EmployeeCreated" />
    </bpmn:intermediateCatchEvent>

    <bpmn:sequenceFlow id="Flow_Msg2_to_GW5" sourceRef="Msg2_EmployeeCreated" targetRef="GW5" />

    <!-- Gateway 5 -->
    <bpmn:exclusiveGateway id="GW5" name="Співробітника створено?">
      <bpmn:incoming>Flow_Msg2_to_GW5</bpmn:incoming>
      <bpmn:outgoing>Flow_GW5_ok</bpmn:outgoing>
      <bpmn:outgoing>Flow_GW5_err</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <bpmn:sequenceFlow id="Flow_GW5_ok" name="Завершено" sourceRef="GW5" targetRef="EndEvent_Success">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=op5.isAbort = false</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_GW5_err" name="Помилка" sourceRef="GW5" targetRef="EndEvent_Abort">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=op5.isAbort = true</bpmn:conditionExpression>
    </bpmn:sequenceFlow>

    <!-- ========================================================== -->
    <!-- END EVENTS                                                  -->
    <!-- ========================================================== -->
    <bpmn:endEvent id="EndEvent_Abort" name="Процес перервано">
      <bpmn:incoming>Flow_GW1_err</bpmn:incoming>
      <bpmn:incoming>Flow_GW2_err</bpmn:incoming>
      <bpmn:incoming>Flow_GW3_err</bpmn:incoming>
      <bpmn:incoming>Flow_GW4_err</bpmn:incoming>
      <bpmn:incoming>Flow_GW5_err</bpmn:incoming>
    </bpmn:endEvent>

    <bpmn:endEvent id="EndEvent_Success" name="Успіх">
      <bpmn:incoming>Flow_GW5_ok</bpmn:incoming>
    </bpmn:endEvent>

  </bpmn:process>

  <!-- ============================================================ -->
  <!-- MESSAGES                                                      -->
  <!-- ============================================================ -->

  <!-- Сигнал від 1С: фізичну особу створено -->
  <bpmn:message id="Msg_PersonCreated" name="PersonCreated">
    <bpmn:extensionElements>
      <zeebe:subscription correlationKey="=documentID" />
    </bpmn:extensionElements>
  </bpmn:message>

  <!-- Сигнал від 1С: співробітника створено -->
  <bpmn:message id="Msg_EmployeeCreated" name="EmployeeCreated">
    <bpmn:extensionElements>
      <zeebe:subscription correlationKey="=documentID" />
    </bpmn:extensionElements>
  </bpmn:message>

  <!-- ============================================================ -->
  <!-- DIAGRAM                                                       -->
  <!-- ============================================================ -->
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_DO3_Integration">

      <!-- Start -->
      <bpmndi:BPMNShape id="StartEvent_1_di" bpmnElement="StartEvent_1">
        <dc:Bounds x="152" y="242" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="156" y="285" width="28" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- User Task -->
      <bpmndi:BPMNShape id="Activity_RegistrationForm_di" bpmnElement="Activity_RegistrationForm">
        <dc:Bounds x="250" y="220" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- ST1: Створити документ -->
      <bpmndi:BPMNShape id="ST1_CreateDoc_di" bpmnElement="ST1_CreateDoc">
        <dc:Bounds x="410" y="220" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- GW1 -->
      <bpmndi:BPMNShape id="GW1_di" bpmnElement="GW1" isMarkerVisible="true">
        <dc:Bounds x="570" y="235" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="550" y="205" width="90" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- ST2: Запустити скрипт ФО -->
      <bpmndi:BPMNShape id="ST2_TriggerFO_di" bpmnElement="ST2_TriggerFO">
        <dc:Bounds x="680" y="220" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- GW2 -->
      <bpmndi:BPMNShape id="GW2_di" bpmnElement="GW2" isMarkerVisible="true">
        <dc:Bounds x="840" y="235" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="820" y="205" width="90" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- Msg1: Очікування ФО -->
      <bpmndi:BPMNShape id="Msg1_PersonCreated_di" bpmnElement="Msg1_PersonCreated">
        <dc:Bounds x="947" y="242" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="925" y="285" width="80" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- GW3 -->
      <bpmndi:BPMNShape id="GW3_di" bpmnElement="GW3" isMarkerVisible="true">
        <dc:Bounds x="1040" y="235" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1025" y="205" width="80" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- ST3: Запустити скрипт Співробітника -->
      <bpmndi:BPMNShape id="ST3_TriggerEmployee_di" bpmnElement="ST3_TriggerEmployee">
        <dc:Bounds x="1150" y="220" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- GW4 -->
      <bpmndi:BPMNShape id="GW4_di" bpmnElement="GW4" isMarkerVisible="true">
        <dc:Bounds x="1310" y="235" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1295" y="205" width="80" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- Msg2: Очікування Співробітника -->
      <bpmndi:BPMNShape id="Msg2_EmployeeCreated_di" bpmnElement="Msg2_EmployeeCreated">
        <dc:Bounds x="1417" y="242" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1393" y="285" width="84" height="40" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- GW5 -->
      <bpmndi:BPMNShape id="GW5_di" bpmnElement="GW5" isMarkerVisible="true">
        <dc:Bounds x="1510" y="235" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1490" y="205" width="90" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- End Success -->
      <bpmndi:BPMNShape id="EndEvent_Success_di" bpmnElement="EndEvent_Success">
        <dc:Bounds x="1622" y="242" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1626" y="285" width="28" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- End Abort -->
      <bpmndi:BPMNShape id="EndEvent_Abort_di" bpmnElement="EndEvent_Abort">
        <dc:Bounds x="847" y="412" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="817" y="455" width="96" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- ====== FLOWS ====== -->

      <bpmndi:BPMNEdge id="Flow_To_Form_di" bpmnElement="Flow_To_Form">
        <di:waypoint x="188" y="260" />
        <di:waypoint x="250" y="260" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="Flow_To_ST1_di" bpmnElement="Flow_To_ST1">
        <di:waypoint x="350" y="260" />
        <di:waypoint x="410" y="260" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="Flow_ST1_to_GW1_di" bpmnElement="Flow_ST1_to_GW1">
        <di:waypoint x="510" y="260" />
        <di:waypoint x="570" y="260" />
      </bpmndi:BPMNEdge>

      <!-- GW1 → ST2 (OK) -->
      <bpmndi:BPMNEdge id="Flow_GW1_ok_di" bpmnElement="Flow_GW1_ok">
        <di:waypoint x="620" y="260" />
        <di:waypoint x="680" y="260" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="643" y="242" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <!-- GW1 → Abort -->
      <bpmndi:BPMNEdge id="Flow_GW1_err_di" bpmnElement="Flow_GW1_err">
        <di:waypoint x="595" y="285" />
        <di:waypoint x="595" y="430" />
        <di:waypoint x="847" y="430" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="600" y="350" width="46" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="Flow_ST2_to_GW2_di" bpmnElement="Flow_ST2_to_GW2">
        <di:waypoint x="780" y="260" />
        <di:waypoint x="840" y="260" />
      </bpmndi:BPMNEdge>

      <!-- GW2 → Msg1 (OK) -->
      <bpmndi:BPMNEdge id="Flow_GW2_ok_di" bpmnElement="Flow_GW2_ok">
        <di:waypoint x="890" y="260" />
        <di:waypoint x="947" y="260" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="911" y="242" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <!-- GW2 → Abort -->
      <bpmndi:BPMNEdge id="Flow_GW2_err_di" bpmnElement="Flow_GW2_err">
        <di:waypoint x="865" y="285" />
        <di:waypoint x="865" y="412" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="870" y="345" width="46" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="Flow_Msg1_to_GW3_di" bpmnElement="Flow_Msg1_to_GW3">
        <di:waypoint x="983" y="260" />
        <di:waypoint x="1040" y="260" />
      </bpmndi:BPMNEdge>

      <!-- GW3 → ST3 (OK) -->
      <bpmndi:BPMNEdge id="Flow_GW3_ok_di" bpmnElement="Flow_GW3_ok">
        <di:waypoint x="1090" y="260" />
        <di:waypoint x="1150" y="260" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1113" y="242" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <!-- GW3 → Abort -->
      <bpmndi:BPMNEdge id="Flow_GW3_err_di" bpmnElement="Flow_GW3_err">
        <di:waypoint x="1065" y="285" />
        <di:waypoint x="1065" y="430" />
        <di:waypoint x="883" y="430" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1070" y="350" width="46" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="Flow_ST3_to_GW4_di" bpmnElement="Flow_ST3_to_GW4">
        <di:waypoint x="1250" y="260" />
        <di:waypoint x="1310" y="260" />
      </bpmndi:BPMNEdge>

      <!-- GW4 → Msg2 (OK) -->
      <bpmndi:BPMNEdge id="Flow_GW4_ok_di" bpmnElement="Flow_GW4_ok">
        <di:waypoint x="1360" y="260" />
        <di:waypoint x="1417" y="260" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1381" y="242" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <!-- GW4 → Abort -->
      <bpmndi:BPMNEdge id="Flow_GW4_err_di" bpmnElement="Flow_GW4_err">
        <di:waypoint x="1335" y="285" />
        <di:waypoint x="1335" y="430" />
        <di:waypoint x="883" y="430" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1340" y="350" width="46" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="Flow_Msg2_to_GW5_di" bpmnElement="Flow_Msg2_to_GW5">
        <di:waypoint x="1453" y="260" />
        <di:waypoint x="1510" y="260" />
      </bpmndi:BPMNEdge>

      <!-- GW5 → End Success (OK) -->
      <bpmndi:BPMNEdge id="Flow_GW5_ok_di" bpmnElement="Flow_GW5_ok">
        <di:waypoint x="1560" y="260" />
        <di:waypoint x="1622" y="260" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1565" y="242" width="54" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <!-- GW5 → Abort -->
      <bpmndi:BPMNEdge id="Flow_GW5_err_di" bpmnElement="Flow_GW5_err">
        <di:waypoint x="1535" y="285" />
        <di:waypoint x="1535" y="430" />
        <di:waypoint x="883" y="430" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1540" y="350" width="46" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>

</bpmn:definitions>
