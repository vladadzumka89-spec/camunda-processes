<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions
  xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL"
  xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
  xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
  xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
  xmlns:zeebe="http://camunda.org/schema/zeebe/1.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:modeler="http://camunda.org/schema/modeler/1.0"
  id="Definitions_DO3_Test"
  targetNamespace="http://bpmn.io/schema/bpmn"
  exporter="Camunda Modeler"
  exporterVersion="5.16.0"
  modeler:executionPlatform="Camunda Cloud"
  modeler:executionPlatformVersion="8.8.0">

  <!-- ============================================================ -->
  <!-- PROCESS                                                       -->
  <!-- ============================================================ -->
  <bpmn:process id="Process_DO3_Integration" name="Інтеграція ДО3 (тест)" isExecutable="true">

    <!-- ========================================================== -->
    <!-- СТАРТ                                                       -->
    <!-- ========================================================== -->
    <bpmn:startEvent id="StartEvent_1" name="Старт">
      <bpmn:outgoing>Flow_To_ST1</bpmn:outgoing>
    </bpmn:startEvent>

    <bpmn:sequenceFlow id="Flow_To_ST1" sourceRef="StartEvent_1" targetRef="ST1_CreateDoc" />

    <!-- ========================================================== -->
    <!-- КРОК 1: Створити документ (REST Outbound Connector)         -->
    <!--   POST → 1С ДО3: створити документ "Заява на стажування"    -->
    <!--   Отримуємо: {status:"OK", documentID:"..."}                -->
    <!-- ========================================================== -->
    <bpmn:serviceTask id="ST1_CreateDoc" name="(1) Створити документ"
      zeebe:modelerTemplate="io.camunda.connectors.HttpJson.v2"
      zeebe:modelerTemplateVersion="12">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="io.camunda:http-json:1" retries="3" />
        <zeebe:ioMapping>
          <zeebe:input source="=&quot;POST&quot;" target="method" />
          <zeebe:input source="=&quot;http://web.dobrom.com/dev_edoc3_abarkin/hs/tut/camunda_document&quot;" target="url" />
          <zeebe:input source="=&quot;basic&quot;" target="authentication.type" />
          <zeebe:input source="=&quot;camunda&quot;" target="authentication.username" />
          <zeebe:input source="=&quot;14412&quot;" target="authentication.password" />
          <zeebe:input source="=20" target="connectionTimeoutInSeconds" />
          <zeebe:input source="=20" target="readTimeoutInSeconds" />
          <zeebe:input source="={&quot;featureCode&quot;: &quot;СтворитиФізОсобу&quot;, &quot;database&quot;: &quot;DO3&quot;, &quot;createDocument&quot;: true, &quot;scriptName&quot;: &quot;Створення фіз особи&quot;, &quot;documentType&quot;: &quot;Заява на стажування.&quot;, &quot;properties&quot;: {&quot;Подразделение&quot;: &quot;c2a0f93b-8fdb-11ec-9285-00115d51d905&quot;, &quot;Прізвище&quot;: &quot;Тестовий&quot;, &quot;Імя&quot;: &quot;Тест&quot;, &quot;ПоБатькові&quot;: &quot;Тестович&quot;, &quot;ДатаЗ&quot;: &quot;20260216000000&quot;, &quot;ДатаПо&quot;: &quot;20260220000000&quot;}}" target="body" />
        </zeebe:ioMapping>
        <zeebe:taskHeaders>
          <zeebe:header key="resultVariable" value="response" />
          <zeebe:header key="resultExpression" value="=if response.status = 200 and response.body.status = &quot;OK&quot; then {documentID: response.body.documentID, isAbort: false} else {isAbort: true, ErrorMessage: response.body.message}" />
          <zeebe:header key="errorExpression" value="" />
          <zeebe:header key="retryBackoff" value="PT0S" />
          <zeebe:header key="elementTemplateVersion" value="12" />
          <zeebe:header key="elementTemplateId" value="io.camunda.connectors.HttpJson.v2" />
        </zeebe:taskHeaders>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_To_ST1</bpmn:incoming>
      <bpmn:outgoing>Flow_ST1_to_GW1</bpmn:outgoing>
    </bpmn:serviceTask>

    <bpmn:sequenceFlow id="Flow_ST1_to_GW1" sourceRef="ST1_CreateDoc" targetRef="GW1" />

    <!-- Gateway 1 -->
    <bpmn:exclusiveGateway id="GW1" name="Документ створено?">
      <bpmn:incoming>Flow_ST1_to_GW1</bpmn:incoming>
      <bpmn:outgoing>Flow_GW1_ok</bpmn:outgoing>
      <bpmn:outgoing>Flow_GW1_err</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <bpmn:sequenceFlow id="Flow_GW1_ok" name="OK" sourceRef="GW1" targetRef="ST2_TriggerFO">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=isAbort = false</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_GW1_err" name="Помилка" sourceRef="GW1" targetRef="EndEvent_Abort">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=isAbort = true</bpmn:conditionExpression>
    </bpmn:sequenceFlow>

    <!-- ========================================================== -->
    <!-- КРОК 2: Запустити скрипт "Створити ФО" (REST)               -->
    <!--   POST → 1С ДО3: створити фізичну особу                    -->
    <!--   Отримуємо: {status:"OK"}                                  -->
    <!-- ========================================================== -->
    <bpmn:serviceTask id="ST2_TriggerFO" name="(2) Запустити скрипт ФО"
      zeebe:modelerTemplate="io.camunda.connectors.HttpJson.v2"
      zeebe:modelerTemplateVersion="12">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="io.camunda:http-json:1" retries="3" />
        <zeebe:ioMapping>
          <zeebe:input source="=&quot;POST&quot;" target="method" />
          <zeebe:input source="=&quot;http://web.dobrom.com/dev_edoc3_abarkin/hs/tut/camunda_document&quot;" target="url" />
          <zeebe:input source="=&quot;basic&quot;" target="authentication.type" />
          <zeebe:input source="=&quot;camunda&quot;" target="authentication.username" />
          <zeebe:input source="=&quot;14412&quot;" target="authentication.password" />
          <zeebe:input source="=20" target="connectionTimeoutInSeconds" />
          <zeebe:input source="=20" target="readTimeoutInSeconds" />
          <zeebe:input source="={&quot;documentID&quot;: documentID, &quot;createDocument&quot;: true, &quot;properties&quot;: {&quot;Наименование&quot;: &quot;Петренко Петро Петрович&quot;, &quot;ДатаРождения&quot;: &quot;1999-03-01&quot;, &quot;Пол&quot;: &quot;Мужской&quot;}, &quot;contact_information&quot;: {&quot;phone&quot;: &quot;+380665554433&quot;, &quot;email&quot;: &quot;1@1.com&quot;}}" target="body" />
        </zeebe:ioMapping>
        <zeebe:taskHeaders>
          <zeebe:header key="resultVariable" value="response" />
          <zeebe:header key="resultExpression" value="=if response.status = 200 and response.body.status = &quot;OK&quot; then {isAbort: false} else {isAbort: true, ErrorMessage: response.body.message}" />
          <zeebe:header key="errorExpression" value="" />
          <zeebe:header key="retryBackoff" value="PT0S" />
          <zeebe:header key="elementTemplateVersion" value="12" />
          <zeebe:header key="elementTemplateId" value="io.camunda.connectors.HttpJson.v2" />
        </zeebe:taskHeaders>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_GW1_ok</bpmn:incoming>
      <bpmn:outgoing>Flow_ST2_to_GW2</bpmn:outgoing>
    </bpmn:serviceTask>

    <bpmn:sequenceFlow id="Flow_ST2_to_GW2" sourceRef="ST2_TriggerFO" targetRef="GW2" />

    <!-- Gateway 2 -->
    <bpmn:exclusiveGateway id="GW2" name="Скрипт ФО запущено?">
      <bpmn:incoming>Flow_ST2_to_GW2</bpmn:incoming>
      <bpmn:outgoing>Flow_GW2_ok</bpmn:outgoing>
      <bpmn:outgoing>Flow_GW2_err</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <bpmn:sequenceFlow id="Flow_GW2_ok" name="OK" sourceRef="GW2" targetRef="Msg1_PersonCreated">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=isAbort = false</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_GW2_err" name="Помилка" sourceRef="GW2" targetRef="EndEvent_Abort">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=isAbort = true</bpmn:conditionExpression>
    </bpmn:sequenceFlow>

    <!-- ========================================================== -->
    <!-- КРОК 3: Очікування сигналу "ФО створено"                    -->
    <!--   1С надсилає message "PersonCreated" з correlationKey=documentID -->
    <!--   Змінні з повідомлення автоматично мерджаться в процес     -->
    <!-- ========================================================== -->
    <bpmn:intermediateCatchEvent id="Msg1_PersonCreated" name="Очікування:&#10;ФО створено">
      <bpmn:incoming>Flow_GW2_ok</bpmn:incoming>
      <bpmn:outgoing>Flow_Msg1_to_GW3</bpmn:outgoing>
      <bpmn:messageEventDefinition id="MsgDef_PersonCreated" messageRef="Msg_PersonCreated" />
    </bpmn:intermediateCatchEvent>

    <bpmn:sequenceFlow id="Flow_Msg1_to_GW3" sourceRef="Msg1_PersonCreated" targetRef="GW3" />

    <!-- Gateway 3 -->
    <bpmn:exclusiveGateway id="GW3" name="ФО створено?">
      <bpmn:incoming>Flow_Msg1_to_GW3</bpmn:incoming>
      <bpmn:outgoing>Flow_GW3_ok</bpmn:outgoing>
      <bpmn:outgoing>Flow_GW3_err</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <bpmn:sequenceFlow id="Flow_GW3_ok" name="OK" sourceRef="GW3" targetRef="ST3_TriggerEmployee">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=status = "OK"</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_GW3_err" name="Помилка" sourceRef="GW3" targetRef="EndEvent_Abort">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=status != "OK"</bpmn:conditionExpression>
    </bpmn:sequenceFlow>

    <!-- ========================================================== -->
    <!-- КРОК 4: Запустити скрипт "Створити співробітника" (REST)     -->
    <!--   POST → 1С ДО3: встановити прапорець СтворитиСпівробітника -->
    <!--   Отримуємо: {status:"OK"}                                  -->
    <!-- ========================================================== -->
    <bpmn:serviceTask id="ST3_TriggerEmployee" name="(4) Запустити скрипт Співробітника"
      zeebe:modelerTemplate="io.camunda.connectors.HttpJson.v2"
      zeebe:modelerTemplateVersion="12">
      <bpmn:extensionElements>
        <zeebe:taskDefinition type="io.camunda:http-json:1" retries="3" />
        <zeebe:ioMapping>
          <zeebe:input source="=&quot;POST&quot;" target="method" />
          <zeebe:input source="=&quot;http://web.dobrom.com/dev_edoc3_abarkin/hs/tut/camunda_document&quot;" target="url" />
          <zeebe:input source="=&quot;basic&quot;" target="authentication.type" />
          <zeebe:input source="=&quot;camunda&quot;" target="authentication.username" />
          <zeebe:input source="=&quot;14412&quot;" target="authentication.password" />
          <zeebe:input source="=20" target="connectionTimeoutInSeconds" />
          <zeebe:input source="=20" target="readTimeoutInSeconds" />
          <zeebe:input source="={&quot;documentID&quot;: documentID, &quot;СтворитиСпівробітника&quot;: true}" target="body" />
        </zeebe:ioMapping>
        <zeebe:taskHeaders>
          <zeebe:header key="resultVariable" value="response" />
          <zeebe:header key="resultExpression" value="=if response.status = 200 and response.body.status = &quot;OK&quot; then {isAbort: false} else {isAbort: true, ErrorMessage: response.body.message}" />
          <zeebe:header key="errorExpression" value="" />
          <zeebe:header key="retryBackoff" value="PT0S" />
          <zeebe:header key="elementTemplateVersion" value="12" />
          <zeebe:header key="elementTemplateId" value="io.camunda.connectors.HttpJson.v2" />
        </zeebe:taskHeaders>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_GW3_ok</bpmn:incoming>
      <bpmn:outgoing>Flow_ST3_to_GW4</bpmn:outgoing>
    </bpmn:serviceTask>

    <bpmn:sequenceFlow id="Flow_ST3_to_GW4" sourceRef="ST3_TriggerEmployee" targetRef="GW4" />

    <!-- Gateway 4 -->
    <bpmn:exclusiveGateway id="GW4" name="Скрипт запущено?">
      <bpmn:incoming>Flow_ST3_to_GW4</bpmn:incoming>
      <bpmn:outgoing>Flow_GW4_ok</bpmn:outgoing>
      <bpmn:outgoing>Flow_GW4_err</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <bpmn:sequenceFlow id="Flow_GW4_ok" name="OK" sourceRef="GW4" targetRef="Msg2_EmployeeCreated">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=isAbort = false</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_GW4_err" name="Помилка" sourceRef="GW4" targetRef="EndEvent_Abort">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=isAbort = true</bpmn:conditionExpression>
    </bpmn:sequenceFlow>

    <!-- ========================================================== -->
    <!-- КРОК 5: Очікування сигналу "Співробітника створено"         -->
    <!--   1С надсилає message "EmployeeCreated" з correlationKey=documentID -->
    <!-- ========================================================== -->
    <bpmn:intermediateCatchEvent id="Msg2_EmployeeCreated" name="Очікування:&#10;Співробітника створено">
      <bpmn:incoming>Flow_GW4_ok</bpmn:incoming>
      <bpmn:outgoing>Flow_Msg2_to_GW5</bpmn:outgoing>
      <bpmn:messageEventDefinition id="MsgDef_EmployeeCreated" messageRef="Msg_EmployeeCreated" />
    </bpmn:intermediateCatchEvent>

    <bpmn:sequenceFlow id="Flow_Msg2_to_GW5" sourceRef="Msg2_EmployeeCreated" targetRef="GW5" />

    <!-- Gateway 5 -->
    <bpmn:exclusiveGateway id="GW5" name="Співробітника створено?">
      <bpmn:incoming>Flow_Msg2_to_GW5</bpmn:incoming>
      <bpmn:outgoing>Flow_GW5_ok</bpmn:outgoing>
      <bpmn:outgoing>Flow_GW5_err</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <bpmn:sequenceFlow id="Flow_GW5_ok" name="Завершено" sourceRef="GW5" targetRef="EndEvent_Success">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=status = "OK"</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_GW5_err" name="Помилка" sourceRef="GW5" targetRef="EndEvent_Abort">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">=status != "OK"</bpmn:conditionExpression>
    </bpmn:sequenceFlow>

    <!-- ========================================================== -->
    <!-- END EVENTS                                                  -->
    <!-- ========================================================== -->
    <bpmn:endEvent id="EndEvent_Abort" name="Процес перервано">
      <bpmn:incoming>Flow_GW1_err</bpmn:incoming>
      <bpmn:incoming>Flow_GW2_err</bpmn:incoming>
      <bpmn:incoming>Flow_GW3_err</bpmn:incoming>
      <bpmn:incoming>Flow_GW4_err</bpmn:incoming>
      <bpmn:incoming>Flow_GW5_err</bpmn:incoming>
    </bpmn:endEvent>

    <bpmn:endEvent id="EndEvent_Success" name="Успіх">
      <bpmn:incoming>Flow_GW5_ok</bpmn:incoming>
    </bpmn:endEvent>

  </bpmn:process>

  <!-- ============================================================ -->
  <!-- MESSAGES                                                      -->
  <!-- ============================================================ -->

  <!-- Сигнал від 1С: фізичну особу створено -->
  <bpmn:message id="Msg_PersonCreated" name="PersonCreated">
    <bpmn:extensionElements>
      <zeebe:subscription correlationKey="=documentID" />
    </bpmn:extensionElements>
  </bpmn:message>

  <!-- Сигнал від 1С: співробітника створено -->
  <bpmn:message id="Msg_EmployeeCreated" name="EmployeeCreated">
    <bpmn:extensionElements>
      <zeebe:subscription correlationKey="=documentID" />
    </bpmn:extensionElements>
  </bpmn:message>

  <!-- ============================================================ -->
  <!-- DIAGRAM                                                       -->
  <!-- ============================================================ -->
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_DO3_Integration">

      <!-- Start -->
      <bpmndi:BPMNShape id="StartEvent_1_di" bpmnElement="StartEvent_1">
        <dc:Bounds x="152" y="242" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="156" y="285" width="28" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- ST1: Створити документ -->
      <bpmndi:BPMNShape id="ST1_CreateDoc_di" bpmnElement="ST1_CreateDoc">
        <dc:Bounds x="410" y="220" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- GW1 -->
      <bpmndi:BPMNShape id="GW1_di" bpmnElement="GW1" isMarkerVisible="true">
        <dc:Bounds x="570" y="235" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="550" y="205" width="90" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- ST2: Запустити скрипт ФО -->
      <bpmndi:BPMNShape id="ST2_TriggerFO_di" bpmnElement="ST2_TriggerFO">
        <dc:Bounds x="680" y="220" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- GW2 -->
      <bpmndi:BPMNShape id="GW2_di" bpmnElement="GW2" isMarkerVisible="true">
        <dc:Bounds x="840" y="235" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="820" y="205" width="90" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- Msg1: Очікування ФО -->
      <bpmndi:BPMNShape id="Msg1_PersonCreated_di" bpmnElement="Msg1_PersonCreated">
        <dc:Bounds x="947" y="242" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="925" y="285" width="80" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- GW3 -->
      <bpmndi:BPMNShape id="GW3_di" bpmnElement="GW3" isMarkerVisible="true">
        <dc:Bounds x="1040" y="235" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1025" y="205" width="80" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- ST3: Запустити скрипт Співробітника -->
      <bpmndi:BPMNShape id="ST3_TriggerEmployee_di" bpmnElement="ST3_TriggerEmployee">
        <dc:Bounds x="1150" y="220" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- GW4 -->
      <bpmndi:BPMNShape id="GW4_di" bpmnElement="GW4" isMarkerVisible="true">
        <dc:Bounds x="1310" y="235" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1295" y="205" width="80" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- Msg2: Очікування Співробітника -->
      <bpmndi:BPMNShape id="Msg2_EmployeeCreated_di" bpmnElement="Msg2_EmployeeCreated">
        <dc:Bounds x="1417" y="242" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1393" y="285" width="84" height="40" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- GW5 -->
      <bpmndi:BPMNShape id="GW5_di" bpmnElement="GW5" isMarkerVisible="true">
        <dc:Bounds x="1510" y="235" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1490" y="205" width="90" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- End Success -->
      <bpmndi:BPMNShape id="EndEvent_Success_di" bpmnElement="EndEvent_Success">
        <dc:Bounds x="1622" y="242" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1626" y="285" width="28" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- End Abort -->
      <bpmndi:BPMNShape id="EndEvent_Abort_di" bpmnElement="EndEvent_Abort">
        <dc:Bounds x="847" y="412" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="817" y="455" width="96" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>

      <!-- ====== FLOWS ====== -->

      <bpmndi:BPMNEdge id="Flow_To_ST1_di" bpmnElement="Flow_To_ST1">
        <di:waypoint x="188" y="260" />
        <di:waypoint x="410" y="260" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="Flow_ST1_to_GW1_di" bpmnElement="Flow_ST1_to_GW1">
        <di:waypoint x="510" y="260" />
        <di:waypoint x="570" y="260" />
      </bpmndi:BPMNEdge>

      <!-- GW1 → ST2 (OK) -->
      <bpmndi:BPMNEdge id="Flow_GW1_ok_di" bpmnElement="Flow_GW1_ok">
        <di:waypoint x="620" y="260" />
        <di:waypoint x="680" y="260" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="643" y="242" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <!-- GW1 → Abort -->
      <bpmndi:BPMNEdge id="Flow_GW1_err_di" bpmnElement="Flow_GW1_err">
        <di:waypoint x="595" y="285" />
        <di:waypoint x="595" y="430" />
        <di:waypoint x="847" y="430" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="600" y="350" width="46" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="Flow_ST2_to_GW2_di" bpmnElement="Flow_ST2_to_GW2">
        <di:waypoint x="780" y="260" />
        <di:waypoint x="840" y="260" />
      </bpmndi:BPMNEdge>

      <!-- GW2 → Msg1 (OK) -->
      <bpmndi:BPMNEdge id="Flow_GW2_ok_di" bpmnElement="Flow_GW2_ok">
        <di:waypoint x="890" y="260" />
        <di:waypoint x="947" y="260" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="911" y="242" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <!-- GW2 → Abort -->
      <bpmndi:BPMNEdge id="Flow_GW2_err_di" bpmnElement="Flow_GW2_err">
        <di:waypoint x="865" y="285" />
        <di:waypoint x="865" y="412" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="870" y="345" width="46" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="Flow_Msg1_to_GW3_di" bpmnElement="Flow_Msg1_to_GW3">
        <di:waypoint x="983" y="260" />
        <di:waypoint x="1040" y="260" />
      </bpmndi:BPMNEdge>

      <!-- GW3 → ST3 (OK) -->
      <bpmndi:BPMNEdge id="Flow_GW3_ok_di" bpmnElement="Flow_GW3_ok">
        <di:waypoint x="1090" y="260" />
        <di:waypoint x="1150" y="260" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1113" y="242" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <!-- GW3 → Abort -->
      <bpmndi:BPMNEdge id="Flow_GW3_err_di" bpmnElement="Flow_GW3_err">
        <di:waypoint x="1065" y="285" />
        <di:waypoint x="1065" y="430" />
        <di:waypoint x="883" y="430" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1070" y="350" width="46" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="Flow_ST3_to_GW4_di" bpmnElement="Flow_ST3_to_GW4">
        <di:waypoint x="1250" y="260" />
        <di:waypoint x="1310" y="260" />
      </bpmndi:BPMNEdge>

      <!-- GW4 → Msg2 (OK) -->
      <bpmndi:BPMNEdge id="Flow_GW4_ok_di" bpmnElement="Flow_GW4_ok">
        <di:waypoint x="1360" y="260" />
        <di:waypoint x="1417" y="260" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1381" y="242" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <!-- GW4 → Abort -->
      <bpmndi:BPMNEdge id="Flow_GW4_err_di" bpmnElement="Flow_GW4_err">
        <di:waypoint x="1335" y="285" />
        <di:waypoint x="1335" y="430" />
        <di:waypoint x="883" y="430" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1340" y="350" width="46" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="Flow_Msg2_to_GW5_di" bpmnElement="Flow_Msg2_to_GW5">
        <di:waypoint x="1453" y="260" />
        <di:waypoint x="1510" y="260" />
      </bpmndi:BPMNEdge>

      <!-- GW5 → End Success (OK) -->
      <bpmndi:BPMNEdge id="Flow_GW5_ok_di" bpmnElement="Flow_GW5_ok">
        <di:waypoint x="1560" y="260" />
        <di:waypoint x="1622" y="260" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1565" y="242" width="54" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

      <!-- GW5 → Abort -->
      <bpmndi:BPMNEdge id="Flow_GW5_err_di" bpmnElement="Flow_GW5_err">
        <di:waypoint x="1535" y="285" />
        <di:waypoint x="1535" y="430" />
        <di:waypoint x="883" y="430" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1540" y="350" width="46" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>

    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>

</bpmn:definitions>
